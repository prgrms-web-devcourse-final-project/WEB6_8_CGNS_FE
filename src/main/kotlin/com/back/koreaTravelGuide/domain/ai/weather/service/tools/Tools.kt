package com.back.koreaTravelGuide.domain.ai.weather.service.tools

import org.springframework.stereotype.Component
import java.time.ZoneId
import java.time.ZonedDateTime
import java.time.format.DateTimeFormatter

@Component("serviceTools")
open class Tools {
    fun getRegionCodeFromLocation(location: String): String {
        return REGION_MAP[location] ?: "11B10101"
    }

    fun validBaseTime(baseTime: String?): String {
        val actualBaseTime =
            if (baseTime != null && (baseTime.endsWith("0600") || baseTime.endsWith("1800"))) {
                println("ğŸ“Œ ì œê³µëœ ë°œí‘œì‹œê° ì‚¬ìš©: $baseTime")
                baseTime
            } else {
                if (baseTime != null) {
                    println("âš ï¸ ì˜ëª»ëœ ë°œí‘œì‹œê° ë¬´ì‹œ: $baseTime (06ì‹œ ë˜ëŠ” 18ì‹œë§Œ ìœ íš¨)")
                }
                getCurrentBaseTime()
            }
        return actualBaseTime
    }

    private fun getCurrentBaseTime(): String {
        // í•œêµ­ì‹œê°„(KST) ê¸°ì¤€ìœ¼ë¡œ í˜„ì¬ ì‹œê°„ ê³„ì‚°
        val now = ZonedDateTime.now(ZoneId.of("Asia/Seoul"))
        val hour = now.hour

        println("ğŸ• í˜„ì¬ KST ì‹œê°„: ${now.format(DateTimeFormatter.ofPattern("yyyy-MM-dd HH:mm:ss"))}")

        return if (hour < 6) {
            // 06ì‹œ ì´ì „ì´ë©´ ì „ë‚  18ì‹œ ë°œí‘œ
            val baseTime = now.minusDays(1).format(DateTimeFormatter.ofPattern("yyyyMMdd")) + "1800"
            println("ğŸ“… ì‚¬ìš©í•  ë°œí‘œì‹œê°: $baseTime (ì „ë‚  18ì‹œ)")
            baseTime
        } else if (hour < 18) {
            // 06ì‹œ~18ì‹œ ì‚¬ì´ë©´ ë‹¹ì¼ 06ì‹œ ë°œí‘œ
            val baseTime = now.format(DateTimeFormatter.ofPattern("yyyyMMdd")) + "0600"
            println("ğŸ“… ì‚¬ìš©í•  ë°œí‘œì‹œê°: $baseTime (ë‹¹ì¼ 06ì‹œ)")
            baseTime
        } else {
            // 18ì‹œ ì´í›„ë©´ ë‹¹ì¼ 18ì‹œ ë°œí‘œ
            val baseTime = now.format(DateTimeFormatter.ofPattern("yyyyMMdd")) + "1800"
            println("ğŸ“… ì‚¬ìš©í•  ë°œí‘œì‹œê°: $baseTime (ë‹¹ì¼ 18ì‹œ)")
            baseTime
        }
    }

    companion object {
        private val REGION_MAP =
            mapOf(
                "ë°±ë ¹ë„" to "11A00101", "ì„œìš¸" to "11B10101", "ê³¼ì²œ" to "11B10102", "ê´‘ëª…" to "11B10103", "ê°•í™”" to "11B20101",
                "ê¹€í¬" to "11B20102", "ì¸ì²œ" to "11B20201", "ì‹œí¥" to "11B20202", "ì•ˆì‚°" to "11B20203", "ë¶€ì²œ" to "11B20204",
                "ì˜ì •ë¶€" to "11B20301", "ê³ ì–‘" to "11B20302", "ì–‘ì£¼" to "11B20304", "íŒŒì£¼" to "11B20305", "ë™ë‘ì²œ" to "11B20401",
                "ì—°ì²œ" to "11B20402", "í¬ì²œ" to "11B20403", "ê°€í‰" to "11B20404", "êµ¬ë¦¬" to "11B20501", "ë‚¨ì–‘ì£¼" to "11B20502",
                "ì–‘í‰" to "11B20503", "í•˜ë‚¨" to "11B20504", "ìˆ˜ì›" to "11B20601", "ì•ˆì–‘" to "11B20602", "ì˜¤ì‚°" to "11B20603",
                "í™”ì„±" to "11B20604", "ì„±ë‚¨" to "11B20605", "í‰íƒ" to "11B20606", "ì˜ì™•" to "11B20609", "êµ°í¬" to "11B20610",
                "ì•ˆì„±" to "11B20611", "ìš©ì¸" to "11B20612", "ì´ì²œ" to "11B20701", "ê´‘ì£¼" to "11B20702", "ì—¬ì£¼" to "11B20703",
                "ì¶©ì£¼" to "11C10101", "ì§„ì²œ" to "11C10102", "ìŒì„±" to "11C10103", "ì œì²œ" to "11C10201", "ë‹¨ì–‘" to "11C10202",
                "ì²­ì£¼" to "11C10301", "ë³´ì€" to "11C10302", "ê´´ì‚°" to "11C10303", "ì¦í‰" to "11C10304", "ì¶”í’ë ¹" to "11C10401",
                "ì˜ë™" to "11C10402", "ì˜¥ì²œ" to "11C10403", "ì„œì‚°" to "11C20101", "íƒœì•ˆ" to "11C20102", "ë‹¹ì§„" to "11C20103",
                "í™ì„±" to "11C20104", "ë³´ë ¹" to "11C20201", "ì„œì²œ" to "11C20202", "ì²œì•ˆ" to "11C20301", "ì•„ì‚°" to "11C20302",
                "ì˜ˆì‚°" to "11C20303", "ëŒ€ì „" to "11C20401", "ê³µì£¼" to "11C20402", "ê³„ë£¡" to "11C20403", "ì„¸ì¢…" to "11C20404",
                "ë¶€ì—¬" to "11C20501", "ì²­ì–‘" to "11C20502", "ê¸ˆì‚°" to "11C20601", "ë…¼ì‚°" to "11C20602", "ì² ì›" to "11D10101",
                "í™”ì²œ" to "11D10102", "ì¸ì œ" to "11D10201", "ì–‘êµ¬" to "11D10202", "ì¶˜ì²œ" to "11D10301", "í™ì²œ" to "11D10302",
                "ì›ì£¼" to "11D10401", "íš¡ì„±" to "11D10402", "ì˜ì›”" to "11D10501", "ì •ì„ " to "11D10502", "í‰ì°½" to "11D10503",
                "ëŒ€ê´€ë ¹" to "11D20201", "íƒœë°±" to "11D20301", "ì†ì´ˆ" to "11D20401", "ê³ ì„±" to "11D20402", "ì–‘ì–‘" to "11D20403",
                "ê°•ë¦‰" to "11D20501", "ë™í•´" to "11D20601", "ì‚¼ì²™" to "11D20602", "ìš¸ë¦‰ë„" to "11E00101", "ë…ë„" to "11E00102",
                "ì „ì£¼" to "11F10201", "ìµì‚°" to "11F10202", "ì •ì" to "11F10203", "ì™„ì£¼" to "11F10204", "ì¥ìˆ˜" to "11F10301",
                "ë¬´ì£¼" to "11F10302", "ì§„ì•ˆ" to "11F10303", "ë‚¨ì›" to "11F10401", "ì„ì‹¤" to "11F10402", "ìˆœì°½" to "11F10403",
                "êµ°ì‚°" to "21F10501", "ê¹€ì œ" to "21F10502", "ê³ ì°½" to "21F10601", "ë¶€ì•ˆ" to "21F10602", "í•¨í‰" to "21F20101",
                "ì˜ê´‘" to "21F20102", "ì§„ë„" to "21F20201", "ì™„ë„" to "11F20301", "í•´ë‚¨" to "11F20302", "ê°•ì§„" to "11F20303",
                "ì¥í¥" to "11F20304", "ì—¬ìˆ˜" to "11F20401", "ê´‘ì–‘" to "11F20402", "ê³ í¥" to "11F20403", "ë³´ì„±" to "11F20404",
                "ìˆœì²œì‹œ" to "11F20405", "ê´‘ì£¼" to "11F20501", "ì¥ì„±" to "11F20502", "ë‚˜ì£¼" to "11F20503", "ë‹´ì–‘" to "11F20504",
                "í™”ìˆœ" to "11F20505", "êµ¬ë¡€" to "11F20601", "ê³¡ì„±" to "11F20602", "ìˆœì²œ" to "11F20603", "í‘ì‚°ë„" to "11F20701",
                "ëª©í¬" to "21F20801", "ì˜ì•”" to "21F20802", "ì‹ ì•ˆ" to "21F20803", "ë¬´ì•ˆ" to "21F20804", "ì„±ì‚°" to "11G00101",
                "ì œì£¼" to "11G00201", "ì„±íŒì•…" to "11G00302", "ì„œê·€í¬" to "11G00401", "ê³ ì‚°" to "11G00501", "ì´ì–´ë„" to "11G00601",
                "ì¶”ìë„" to "11G00800", "ìš¸ì§„" to "11H10101", "ì˜ë•" to "11H10102", "í¬í•­" to "11H10201", "ê²½ì£¼" to "11H10202",
                "ë¬¸ê²½" to "11H10301", "ìƒì£¼" to "11H10302", "ì˜ˆì²œ" to "11H10303", "ì˜ì£¼" to "11H10401", "ë´‰í™”" to "11H10402",
                "ì˜ì–‘" to "11H10403", "ì•ˆë™" to "11H10501", "ì˜ì„±" to "11H10502", "ì²­ì†¡" to "11H10503", "ê¹€ì²œ" to "11H10601",
                "êµ¬ë¯¸" to "11H10602", "êµ°ìœ„" to "11H10707", "ê³ ë ¹" to "11H10604", "ì„±ì£¼" to "11H10605", "ëŒ€êµ¬" to "11H10701",
                "ì˜ì²œ" to "11H10702", "ê²½ì‚°" to "11H10703", "ì²­ë„" to "11H10704", "ì¹ ê³¡" to "11H10705", "ìš¸ì‚°" to "11H20101",
                "ì–‘ì‚°" to "11H20102", "ë¶€ì‚°" to "11H20201", "ì°½ì›" to "11H20301", "ê¹€í•´" to "11H20304", "í†µì˜" to "11H20401",
                "ì‚¬ì²œ" to "11H20402", "ê±°ì œ" to "11H20403", "ê³ ì„±" to "11H20404", "ë‚¨í•´" to "11H20405", "í•¨ì–‘" to "11H20501",
                "ê±°ì°½" to "11H20502", "í•©ì²œ" to "11H20503", "ë°€ì–‘" to "11H20601", "ì˜ë ¹" to "11H20602", "í•¨ì•ˆ" to "11H20603",
                "ì°½ë…•" to "11H20604", "ì§„ì£¼" to "11H20701", "ì‚°ì²­" to "11H20703", "í•˜ë™" to "11H20704", "ì‚¬ë¦¬ì›" to "11I10001",
                "ì‹ ê³„" to "11I10002", "í•´ì£¼" to "11I20001", "ê°œì„±" to "11I20002", "ì¥ì—°(ìš©ì—°)" to "11I20003", "ì‹ ì˜ì£¼" to "11J10001",
                "ì‚­ì£¼(ìˆ˜í’)" to "11J10002", "êµ¬ì„±" to "11J10003", "ìì„±(ì¤‘ê°•)" to "11J10004", "ê°•ê³„" to "11J10005", "í¬ì²œ" to "11J10006",
                "í‰ì–‘" to "11J20001", "ì§„ë‚¨í¬(ë‚¨í¬)" to "11J20002", "ì•ˆì£¼" to "11J20004", "ì–‘ë•" to "11J20005", "ì²­ì§„" to "11K10001",
                "ì›…ê¸°(ì„ ë´‰)" to "11K10002", "ì„±ì§„(ê¹€ì±…)" to "11K10003", "ë¬´ì‚°(ì‚¼ì§€ì—°)" to "11K10004", "í•¨í¥" to "11K20001", "ì¥ì§„" to "11K20002",
                "ë¶ì²­(ì‹ í¬)" to "11K20003", "í˜œì‚°" to "11K20004", "í’ì‚°" to "11K20005", "ì›ì‚°" to "11L10001", "ê³ ì„±(ì¥ì „)" to "11L10002",
                "í‰ê°•" to "11L10003",
            )
    }
}
